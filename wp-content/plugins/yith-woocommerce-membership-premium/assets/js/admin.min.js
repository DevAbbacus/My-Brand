jQuery(function(l){l(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0}),l(".tips-top").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:0,defaultPosition:"top"}),l(".yith-wcmbs-tabs").tabs(),l(".yith-wcmbs-select2").select2(),l(".yith-wcmbs-color-picker").wpColorPicker(),l(".yith-wcmbs-date").datepicker({dateFormat:"yy-mm-dd"});var r={dom:{container:l(".yith-wcmbs-admin-plans-delay").first(),plansList:l("#_yith_wcmbs_restrict_access_plan")},template:wp.template("yith-wcmbs-admin-single-plan-delay"),init:function(){this.dom.container.length&&(this.dom.plansList.on("change",this.plansListChangeHandler).trigger("change"),this.dom.container.on("change",".yith-plugin-fw-radio",this.radioChangeHandler))},plansListChangeHandler:function(){var t,e=l(this),i=r._getRows(),n=e.val(),a=[];for(t in i.each(function(){var t=l(this).data("plan-id")+"";a.push(t),(!n||n.indexOf(t)<0)&&l(this).remove()}),n){var o,s,c=n[t];(!a.length||a.indexOf(c)<0)&&(o=e.find('option[value="'+c+'"]').html(),(s=l(r.template({planID:c,planName:o}))).find("input[type=radio]").each(function(){var t="_yith_wcmbs_single_plan_delay_"+c+"-"+l(this).val();l(this).attr("id",t),l(this).parent().find("label").attr("for",t)}),r.dom.container.append(s))}},radioChangeHandler:function(){var t=l(this).parent().find(".yith-wcmbs-single-plan-delay-field");"delay"===l(this).val()?t.removeAttr("disabled"):t.attr("disabled","disabled")},_getRows:function(){return r.dom.container.find(".yith-wcmbs-single-plan-delay-row")}};r.init();var i=l("#yith-wcmbs-plan-item-order-container"),t=i.find("li").get(),e=l("#yith-wcmbs-plan-item-text"),o={message:null,overlayCSS:{background:"#000",opacity:.6},ignoreIfBlocked:!0};t.sort(function(t,e){var i=parseInt(l(t).attr("rel")),n=parseInt(l(e).attr("rel"));return i<n?-1:n<i?1:0}),l(t).each(function(t,e){i.append(e)}),i.sortable({items:"li",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.8,revert:!0,stop:function(t,e){e.item.hasClass("yith-wcmbs-plan-item-text")&&e.item.find("input").focus()}}),e.draggable({connectToSortable:"#yith-wcmbs-plan-item-order-container",helper:"clone",revert:"invalid",stop:function(t,e){e.helper.html('<input type="text" name="_yith_wcmbs_plan_items[]" /><span class="dashicons dashicons-no-alt close"></span>'),e.helper.css({height:"auto"})}}),i.on("click",".close",function(t){l(t.target).closest("li").remove()}),i.find("li").disableSelection(),e.disableSelection(),i.on("click",".yith-wcmbs-delete-from-plan",function(t){var e=l(t.target),i=e.closest("li"),n=e.data("post-id"),a=e.data("plan-id");i.block(o),l.ajax({url:ajaxurl,type:"POST",data:{action:"yith_wcmbs_remove_plan_for_post",post_id:n,plan_id:a},success:function(t){console.log(t),i.unblock(),i.remove()}})}),i.on("click",".yith-wcmbs-hide-show-item",function(t){var e=l(t.target),i=e.closest("li").children("input.yith_wcmbs_hidden_item_ids"),n=(e.data("post-id"),"show");e.is(".dashicons-visibility")&&(n="hide"),"show"==n?(i.prop("disabled",!0),e.removeClass("dashicons-hidden").addClass("dashicons-visibility")):(i.prop("disabled",!1),e.removeClass("dashicons-visibility").addClass("dashicons-hidden"))}),l("#bulk_edit").on("click",function(){var t=l("#bulk-edit"),e=[];t.find("#bulk-titles").children().each(function(){e.push(l(this).attr("id").replace(/^(ttle)/i,""))});var i=l(".plans-checklist",t).find("input:checked"),n=[];i.each(function(){n.push(l(this).val())}),l.ajax({url:ajaxurl,type:"POST",async:!1,cache:!1,data:{action:"yith_wcmbs_save_bulk_edit",post_ids:e,yith_wcmbs_restrict_access_plan:n}})}),l(document).on("yith_wcmbs_select2_init",function(){var t=l(".yith_wcmbs_ajax_select2_select_customer");t.each(function(){var t={allowClear:!!l(this).data("allow_clear"),placeholder:l(this).data("placeholder"),minimumInputLength:l(this).data("minimum_input_length")?l(this).data("minimum_input_length"):"3",escapeMarkup:function(t){return t},ajax:{url:ajaxurl,dataType:"json",quietMillis:250,data:function(t){return{term:t.term,action:"woocommerce_json_search_customers",security:yith_wcmbs_admin.customer_nonce}},processResults:function(t){var i=[];return t&&l.each(t,function(t,e){i.push({id:t,text:e})}),{results:i}},cache:!0}};l(this).select2(t)}),t.on("yith_wcmbs_select2_reset",function(){l(this).val("").trigger("change")}).trigger("yith_wcmbs_select2_reset")}).trigger("yith_wcmbs_select2_init"),l(".yith-wcmbs-select2-select-all").on("click",function(t){var e=l(t.target).data("container-id"),i=l("#"+e).find(".yith-wcmbs-select2").first();i.find("option").prop("selected",!0),i.trigger("change")}),l(".yith-wcmbs-select2-deselect-all").on("click",function(t){var e=l(t.target).data("container-id"),i=l("#"+e).find(".yith-wcmbs-select2").first();i.find("option:selected").removeAttr("selected"),i.trigger("change")}),l(document).on("click",".yith-wcmbs-copy-to-clipboard",function(t){var e,i=l(this).data("selector-to-copy"),n=l(i);0<n.length&&(e=l("<input>"),l("body").append(e),e.val(n.html()).select(),document.execCommand("copy"),e.remove())});var n={target:".yith-wcmbs-show-conditional:not(.yith-wcmbs-show-conditional--initialized)",initEvent:"yith-wcmbs-show-conditional-init",init:function(){l(n.target).hide().each(function(){var n,a,o,t=l(this),e=t.data("dep-selector"),s=l(e),i=t.data("dep-value");s.length&&(a=i.split(","),s.on("change keyup",function(){var i=!0;s.each(function(t){var e=l(this);o=a[t],(n=e.is("input[type=checkbox]"))&&(o="no"!==o),(n?e.is(":checked"):e.val())!==o&&(i=!1)}),i?t.show():t.hide()}).trigger("change"),t.addClass("yith-wcmbs-show-conditional--initialized"))})}};l(document).on(n.initEvent,n.init),n.init();var a={dom:{hideContents:l("#yith-wcmbs-hide-contents"),alternativeContentMode:l("#yith-wcmbs-default-alternative-content-mode"),alternativeContentContainer:l("#yith-wcmbs-default-alternative-content").closest(".yith-plugin-fw-panel-wc-row"),alternativeContentIDContainer:l("#yith-wcmbs-default-alternative-content-id").closest(".yith-plugin-fw-panel-wc-row")},init:function(){var t=a;t.dom.hideContents.on("change",t.handleAlternativeContentVisibility),t.dom.alternativeContentMode.on("change",t.handleAlternativeContentVisibility),t.handleAlternativeContentVisibility()},handleAlternativeContentVisibility:function(){var t=a,e=!1,i=!1;"alternative_content"===t.dom.hideContents.val()&&("set"===t.dom.alternativeContentMode.val()?e=!0:i=!0),e?t.dom.alternativeContentContainer.show():t.dom.alternativeContentContainer.hide(),i?t.dom.alternativeContentIDContainer.show():t.dom.alternativeContentIDContainer.hide()}};a.init()});